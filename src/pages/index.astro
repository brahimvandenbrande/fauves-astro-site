---
import type { CollectionEntry } from "astro:content";
import WebsiteStructuredData from "@components/WebsiteStructuredData.astro";
import Layout from "@layouts/Layout.astro";
import Navigation from "@components/Navigation.astro";
import Footer from "@components/Footer.astro";
import video480mp4 from "@assets/videos/fauves-agency-intro_480p.mp4";
import video480webm from "@assets/videos/fauves-agency-intro_480p.webm";
import video720mp4 from "@assets/videos/fauves-agency-intro_720p.mp4";
import video720webm from "@assets/videos/fauves-agency-intro_720p.webm";
import video1080mp4 from "@assets/videos/fauves-agency-intro_1080p.mp4";
import video1080webm from "@assets/videos/fauves-agency-intro_1080p.webm";
import ProjectCarousel from "@components/ProjectCarousel.astro";
import { getCollection } from "astro:content";

// Get all projects, sorted by date (newest first)
const allProjects = (await getCollection("projects")).sort(
  (a: CollectionEntry<"projects">, b: CollectionEntry<"projects">) =>
    b.data.date.getTime() - a.data.date.getTime()
);

// Get featured projects (where featured: true)
const featuredProjects = allProjects.filter(
  (project: CollectionEntry<"projects">) => project.data.featured
);
---

<Layout
  title="Home"
  description="FAUVES ‚Äì studio de branding et narration de marque."
>
  <WebsiteStructuredData slot="structured-data" />

  <!-- üß≠ Navigation principale -->
  <header>
    <Navigation />
  </header>

  <!-- üéØ Contenu principal de la page -->
  <main class="mx-auto flex max-w-[85rem] flex-col gap-12 px-4 pt-24 pb-16">
    <!-- ü¶Å Hero principal -->
    <section>
      <h1
        class="text-h1 leading-h1 font-degular w-full max-w-[75.6rem] font-light text-black"
      >
        Ici, nous cr√©ons des <span class="font-semibold">marques vivantes</span
        >. Activables, utiles et qui √©voluent avec vous.
      </h1>
    </section>

    <!-- Projects Carousel -->
    <ProjectCarousel projects={featuredProjects} />

    <section class="mx-auto max-w-6xl px-4 pb-16 text-center">
      <p
        class="font-degular text-[4.06rem] leading-[4.06rem] font-light text-black"
      >
        Vous cherchez √† inspirer autant qu‚Äô√† performer‚ÄØ? Chez FAUVES, nous
        donnons vie √†
        <span class="font-semibold">des identit√©s fortes</span>, des r√©cits qui
        r√©sonnent et des marques qui engagent.
      </p>
    </section>

    <section
      class="relative mx-auto aspect-video w-full max-w-[1209.75px] overflow-hidden rounded-xl bg-black"
      aria-label="FAUVES Agency visual presentation"
    >
      <div class="sr-only">
        <h2>FAUVES Agency Visual Presentation</h2>
        <p>Animated showcase of FAUVES Agency's work and creative process.</p>
      </div>
      <video
        aria-hidden="true"
        autoplay
        muted
        playsinline
        loop
        preload="auto"
        class="h-full w-full object-cover"
      >
        <source
          src={video1080webm}
          type="video/webm"
          media="(min-width: 1024px)"
        />
        <source
          src={video1080mp4}
          type="video/mp4"
          media="(min-width: 1024px)"
        />
        <source
          src={video720webm}
          type="video/webm"
          media="(min-width: 640px)"
        />
        <source src={video720mp4} type="video/mp4" media="(min-width: 640px)" />
        <source src={video480webm} type="video/webm" />
        <source src={video480mp4} type="video/mp4" />
        <!-- No fallback needed as the video is purely decorative -->
      </video>
    </section>

    <!-- üß† Autres sections (valeurs, m√©thode, clients, etc.) -->
    <!-- <section>...</section> -->
  </main>

  <!-- ü¶∂ Pied de page (optionnel) -->
  <footer>
    <Footer />
  </footer>
</Layout>
